ubuntu@demo-namenode:/exports/projects/spark-3.0.0-preview2-bin-hadoop3.2$ time bin/spark-submit --class SparkSort --master yarn --deploy-mode cluster --driver-memory 4g --executor-memory 2g --executor-cores 4 --num-executors 4 SparkSort.jar /home/input/1GB.txt /home/output/
2020-05-02 19:04:12,312 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2020-05-02 19:04:12,377 INFO client.RMProxy: Connecting to ResourceManager at /192.168.122.145:8032
2020-05-02 19:04:12,724 INFO yarn.Client: Requesting a new application from cluster with 1 NodeManagers
2020-05-02 19:04:12,802 INFO conf.Configuration: resource-types.xml not found
2020-05-02 19:04:12,802 INFO resource.ResourceUtils: Unable to find 'resource-types.xml'.
2020-05-02 19:04:12,818 INFO yarn.Client: Verifying our application has not requested more than the maximum memory capability of the cluster (8192 MB per container)
2020-05-02 19:04:12,819 INFO yarn.Client: Will allocate AM container, with 4505 MB memory including 409 MB overhead
2020-05-02 19:04:12,819 INFO yarn.Client: Setting up container launch context for our AM
2020-05-02 19:04:12,820 INFO yarn.Client: Setting up the launch environment for our AM container
2020-05-02 19:04:12,830 INFO yarn.Client: Preparing resources for our AM container
2020-05-02 19:04:13,182 WARN yarn.Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
2020-05-02 19:04:15,005 INFO yarn.Client: Uploading resource file:/tmp/spark-4b010abc-ed2d-4f50-a412-47af05dadba6/__spark_libs__7747213236458474470.zip -> /exports/projects/sparkstaging/ubuntu/.sparkStaging/application_1588445282937_0003/__spark_libs__7747213236458474470.zip
2020-05-02 19:04:16,421 INFO yarn.Client: Uploading resource file:/exports/projects/spark-3.0.0-preview2-bin-hadoop3.2/SparkSort.jar -> /exports/projects/sparkstaging/ubuntu/.sparkStaging/application_1588445282937_0003/SparkSort.jar
2020-05-02 19:04:16,643 INFO yarn.Client: Uploading resource file:/tmp/spark-4b010abc-ed2d-4f50-a412-47af05dadba6/__spark_conf__2300409381835623247.zip -> /exports/projects/sparkstaging/ubuntu/.sparkStaging/application_1588445282937_0003/__spark_conf__.zip
2020-05-02 19:04:16,714 INFO spark.SecurityManager: Changing view acls to: ubuntu
2020-05-02 19:04:16,714 INFO spark.SecurityManager: Changing modify acls to: ubuntu
2020-05-02 19:04:16,714 INFO spark.SecurityManager: Changing view acls groups to: 
2020-05-02 19:04:16,715 INFO spark.SecurityManager: Changing modify acls groups to: 
2020-05-02 19:04:16,715 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(ubuntu); groups with view permissions: Set(); users  with modify permissions: Set(ubuntu); groups with modify permissions: Set()
2020-05-02 19:04:16,770 INFO yarn.Client: Submitting application application_1588445282937_0003 to ResourceManager
2020-05-02 19:04:16,812 INFO impl.YarnClientImpl: Submitted application application_1588445282937_0003
2020-05-02 19:04:17,818 INFO yarn.Client: Application report for application_1588445282937_0003 (state: ACCEPTED)
2020-05-02 19:04:17,825 INFO yarn.Client: 
	 client token: N/A
	 diagnostics: AM container is launched, waiting for AM container to Register with RM
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: default
	 start time: 1588446256784
	 final status: UNDEFINED
	 tracking URL: http://demo-namenode.local:8088/proxy/application_1588445282937_0003/
	 user: ubuntu
2020-05-02 19:04:18,828 INFO yarn.Client: Application report for application_1588445282937_0003 (state: ACCEPTED)
2020-05-02 19:04:19,833 INFO yarn.Client: Application report for application_1588445282937_0003 (state: ACCEPTED)
2020-05-02 19:04:20,838 INFO yarn.Client: Application report for application_1588445282937_0003 (state: ACCEPTED)
2020-05-02 19:04:21,842 INFO yarn.Client: Application report for application_1588445282937_0003 (state: ACCEPTED)
2020-05-02 19:04:22,846 INFO yarn.Client: Application report for application_1588445282937_0003 (state: ACCEPTED)
2020-05-02 19:04:23,849 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:23,850 INFO yarn.Client: 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: demo-datanode1.local
	 ApplicationMaster RPC port: 38709
	 queue: default
	 start time: 1588446256784
	 final status: UNDEFINED
	 tracking URL: http://demo-namenode.local:8088/proxy/application_1588445282937_0003/
	 user: ubuntu
2020-05-02 19:04:24,854 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:25,858 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:26,862 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:27,867 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:28,870 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:29,874 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:30,877 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:31,885 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:32,888 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:33,890 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:34,894 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:35,897 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:36,900 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:37,902 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:38,906 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:39,909 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:40,912 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:41,916 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:42,919 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:43,923 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:44,927 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:45,930 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:46,933 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:47,937 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:48,940 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:49,944 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:50,948 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:51,951 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:52,954 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:53,958 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:54,962 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:55,965 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:56,969 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:57,973 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:58,976 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:04:59,980 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:00,983 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:01,986 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:02,989 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:03,992 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:04,996 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:05,999 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:07,004 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:08,007 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:09,010 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:10,014 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:11,017 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:12,020 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:13,024 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:14,027 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:15,030 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:16,034 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:17,037 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:18,040 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:19,044 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:20,047 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:21,051 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:22,054 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:23,058 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:24,061 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:25,065 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:26,068 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:27,071 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:28,075 INFO yarn.Client: Application report for application_1588445282937_0003 (state: RUNNING)
2020-05-02 19:05:29,078 INFO yarn.Client: Application report for application_1588445282937_0003 (state: FINISHED)
2020-05-02 19:05:29,079 INFO yarn.Client: 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: demo-datanode1.local
	 ApplicationMaster RPC port: 38709
	 queue: default
	 start time: 1588446256784
	 final status: SUCCEEDED
	 tracking URL: http://demo-namenode.local:8088/proxy/application_1588445282937_0003/
	 user: ubuntu
2020-05-02 19:05:29,101 INFO util.ShutdownHookManager: Shutdown hook called
2020-05-02 19:05:29,103 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-4b010abc-ed2d-4f50-a412-47af05dadba6
2020-05-02 19:05:29,110 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-6f00a97c-6a0d-45c7-9205-213b95bace18

real	0m18.564s
user	0m3.084s
sys	0m0.385s

./valsort -o part-00000.sum ../output/part-00000
Records: 677364
Checksum: 52b157acfbc9c
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00001.sum ../output/part-00001
Records: 710467
Checksum: 56b34d484c73d
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00002.sum ../output/part-00002
Records: 715614
Checksum: 57468d2845832
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00003.sum ../output/part-00003
Records: 678794
Checksum: 52cc90bd95b67
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00004.sum ../output/part-00004
Records: 618730
Checksum: 4b72012e2f406
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00005.sum ../output/part-00005
Records: 688362
Checksum: 53fbe73b0a278
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00006.sum ../output/part-00006
Records: 736862
Checksum: 59f480a8807a7
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00007.sum ../output/part-00007
Records: 540452
Checksum: 41fed0d4a7e87
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00008.sum ../output/part-00008
Records: 675605
Checksum: 5292fcdc25dce
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00009.sum ../output/part-00009
Records: 720097
Checksum: 58018e62c4089
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00010.sum ../output/part-00010
Records: 574116
Checksum: 45f34426aee15
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00011.sum ../output/part-00011
Records: 589634
Checksum: 47f380f3f5b54
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00012.sum ../output/part-00012
Records: 617760
Checksum: 4b6542945a232
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00013.sum ../output/part-00013
Records: 663954
Checksum: 510e34d33b5df
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00014.sum ../output/part-00014
Records: 754291
Checksum: 5c100030b78fa
Duplicate keys: 0
SUCCESS - all records are in order
./valsort -o part-00015.sum ../output/part-00015
Records: 775316
Checksum: 5eb1363c86e4b
Duplicate keys: 0
SUCCESS - all records are in order
cat part-00000.sum part-00001.sum part-00002.sum part-00003.sum part-00004.sum part-00005.sum part-00006.sum part-00007.sum part-00008.sum part-00009.sum part-00010.sum part-00011.sum part-00012.sum part-00013.sum part-00014.sum part-00015.sum 
./valsort -s all.sum
Records: 10737418
Checksum: 51e88faefe7b34
Duplicate keys: 0
SUCCESS - all records are in order


